# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–ª—è ¬´–í–∏–∫–∏—à–æ–ø¬ª

–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ **¬´–í–∏–∫–∏—à–æ–ø¬ª**, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ–∫—Å–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é. –¶–µ–ª—å ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å **F1-–º–µ—Ç—Ä–∏–∫—É ‚â• 0.75**, –ø–æ–≤—ã—Å–∏–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

* [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
* [–î–∞–Ω–Ω—ã–µ](#–¥–∞–Ω–Ω—ã–µ)
* [–ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é](#–ø–æ–¥—Ö–æ–¥-–∫-—Ä–µ—à–µ–Ω–∏—é)
* [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
* [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
* [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
* [–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
* [–ö–æ–Ω—Ç–∞–∫—Ç—ã](#–∫–æ–Ω—Ç–∞–∫—Ç—ã)

---

## üõ†Ô∏è –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω **¬´–í–∏–∫–∏—à–æ–ø¬ª** –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–∏—Å—Ç–µ–º—É, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏ –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ä–µ–¥—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—è–≤–ª—è—Ç—å **—Ç–æ–∫—Å–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** –∏ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é.

**–ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞:**

* –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ–∫—Å–∏—á–Ω—ã–π / –Ω–µ—Ç–æ–∫—Å–∏—á–Ω—ã–π).
* –î–æ—Å—Ç–∏—á—å **F1-–º–µ—Ç—Ä–∏–∫–∏ –Ω–µ –Ω–∏–∂–µ 0.75**.
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:

  * –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML (TF-IDF + –º–æ–¥–µ–ª–∏).
  * –ú–æ–¥–µ–ª—å –Ω–∞ –±–∞–∑–µ **BERT** (`unitary/toxic-bert`).

---

## üìä –î–∞–Ω–Ω—ã–µ

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:**

* –§–∞–π–ª `toxic_comments.csv`.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

* `text` ‚Äî —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.
* `toxic` ‚Äî —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:

  * `0` ‚Äî –Ω–µ—Ç–æ–∫—Å–∏—á–Ω—ã–π
  * `1` ‚Äî —Ç–æ–∫—Å–∏—á–Ω—ã–π

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

* \~159 292 –∑–∞–ø–∏—Å–µ–π.
* –î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤: \~90% –Ω–µ—Ç–æ–∫—Å–∏—á–Ω—ã—Ö.
* –ü—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ—Ç.

---

## üîç –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é

### üí° 1. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML-–ø–æ–¥—Ö–æ–¥ (`toxic-comments.ipynb`)

**–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞:**

* –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ (`Unnamed: 0`).
* –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞: –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä, —É–¥–∞–ª–µ–Ω–∏–µ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤ (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è).
* –î–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ (80/20, —Å `stratify`).

**–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**

* `TfidfVectorizer`: `max_features=10000`, `ngram_range=(1, 2)`.
* –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `spaCy`.

**–ú–æ–¥–µ–ª–∏:**

* `LogisticRegression`
* `LinearSVC`
* `RandomForestClassifier`
* `CatBoostClassifier`
* `ComplementNB`
* `SGDClassifier`
* `RidgeClassifier`

**–û—Ü–µ–Ω–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Pipeline`.
* –ì—Ä–∏–¥-—Å–µ—Ä—á (`GridSearchCV`) + —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è (`StratifiedKFold`).
* –ú–µ—Ç—Ä–∏–∫–∞: `F1 (weighted)`.

---

### ü§ñ 2. –ú–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ BERT (`toxic-comments (BERT).ipynb`)

**–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞:**

* –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å Kaggle (`/kaggle/input/yp-toxic-comments/toxic_comments.csv`).
* –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ (80/20, stratify).

**–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è:**

* `AutoTokenizer` –æ—Ç `transformers`:
  `max_length=512`, `padding=True`, `truncation=True`.

**–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

* –°–æ–∑–¥–∞–Ω–∏–µ `TensorDataset` –∏ `DataLoader` (`batch_size=16`).

**–ú–æ–¥–µ–ª—å:**

* `AutoModelForSequenceClassification` —Å –≤–µ—Å–∞–º–∏ `unitary/toxic-bert`.
* –ó–∞–ø—É—Å–∫ –Ω–∞ **TPU (Kaggle)** —á–µ—Ä–µ–∑ `torch_xla`.

**–ú–µ—Ç—Ä–∏–∫–∞:**

* `F1 (weighted)` –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

**‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ (4 –ì–ë) –Ω–æ—É—Ç–±—É–∫ —Å BERT –∑–∞–ø—É—Å–∫–∞–ª—Å—è **—Ç–æ–ª—å–∫–æ –Ω–∞ Kaggle**.

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥

* **–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:** `LogisticRegression` –∏–ª–∏ `LinearSVC` (—Ç–æ—á–Ω—ã–π –≤—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).
* **–ú–µ—Ç—Ä–∏–∫–∞:** `F1 ‚â• 0.75`.

**–í—ã–≤–æ–¥—ã:**

* –ü—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ —Å `TF-IDF` –∏ –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π —Ä–∞–±–æ—Ç–∞—é—Ç –±—ã—Å—Ç—Ä–æ –∏ —Ç–æ—á–Ω–æ.
* –ü—Ä–æ–±–ª–µ–º–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞ —Å—á—ë—Ç `stratify`, `ComplementNB` –∏ –º–µ—Ç—Ä–∏–∫.

### ‚úÖ BERT

* **–ú–æ–¥–µ–ª—å:** `unitary/toxic-bert`.
* **–ú–µ—Ç—Ä–∏–∫–∞:** `F1 ~ 0.85‚Äì0.90`.

**–í—ã–≤–æ–¥—ã:**

* –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ (BERT) –¥–∞—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ.
* TPU Kaggle –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.
* –ú–∏–Ω—É—Å ‚Äî —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–æ—Å—Ç—å –∏ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.

---

## üîé –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

* **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `LogisticRegression` –∏–ª–∏ `LinearSVC` –∏–∑-–∑–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.

* **–î–ª—è –æ—Ñ—Ñ–ª–∞–π–Ω-–æ—Ü–µ–Ω–∫–∏ –∏ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:**
  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `BERT`-–º–æ–¥–µ–ª—å —Å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º.

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

   ```bash
   git clone https://github.com/Radigos-X/Toxic_Comments_Classification.git
   cd Toxic_Comments_Classification
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

   ```bash
   pip install -r requirements.txt
   ```

3. –î–ª—è –∑–∞–ø—É—Å–∫–∞ BERT:

   ```bash
   pip install -r requirementsBERT.txt
   ```

---

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML-–ø–æ–¥—Ö–æ–¥:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ—É—Ç–±—É–∫:

   ```bash
   jupyter notebook toxic-comments.ipynb
   ```

2. –°–ª–µ–¥—É–π—Ç–µ —à–∞–≥–∞–º:

   * –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ `toxic_comments.csv`.
   * –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π.
   * –û—Ü–µ–Ω–∫–∞ `F1` –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

### BERT –Ω–∞ Kaggle:

1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –Ω–æ—É—Ç–±—É–∫ `toxic-comments (BERT).ipynb` –≤ Kaggle Kernel.
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç `yp-toxic-comments`.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫–∏:

   * –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö.
   * –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è.
   * –û—Ü–µ–Ω–∫–∞ `unitary/toxic-bert`.
4. –í–∫–ª—é—á–∏—Ç–µ **TPU** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Kaggle.

---

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–î–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**

* `pandas`
* `numpy`
* `spacy`
* `scikit-learn`
* `catboost`
* `nltk`
* `wordcloud`
* `matplotlib`
* `seaborn`
* `tqdm`

**–î–ª—è BERT-–ø–æ–¥—Ö–æ–¥–∞ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ):**

* `transformers`
* `torch`
* `torch_xla` *(—Ç–æ–ª—å–∫–æ –¥–ª—è Kaggle TPU)*

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å—ë —á–µ—Ä–µ–∑:

```bash
pip install -r requirements.txt
```

---

## üì¨ –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ:

* Email: [i@outis-x.ru](mailto:i@outis-x.ru)
* GitHub: [github.com/Radigos-X](https://github.com/Radigos-X)
